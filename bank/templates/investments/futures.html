<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Futures</title>
</head>
<body>
    <h1 style="position: relative; text-align: center;">Futures Trading</h1>
    
    <div style="position: relative; text-align: center; margin-bottom: 20px;">
        <a href="{{url_for("bank_views.investmentsPage", customer_name=customer_name)}}">Back to Portfolio</a>
    </div>
    
    {% if error %}
    <div style="color: red; text-align: center; margin-bottom: 20px;">
        {{ error }}
    </div>
    {% endif %}
    
    <!-- Open Position Form -->
    <div style="margin: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px;">
        <h2>Open Futures Position</h2>
        <form method="POST">
            <input type="hidden" name="action" value="open">
            <div style="margin-bottom: 10px;">
                <label for="futures_symbol">Select Futures Contract:</label>
                <select name="futures_symbol" id="futures_symbol" required>
                    <option value="">-- Select a futures contract --</option>
                    {% for future in available_futures %}
                    <option value="{{ future[0] }}">{{ future[1] }} ({{ future[0] }}) - ${{ future[2] }} (Margin: {{ future[3]*100 }}%, Expiry: {{ future[4] }})</option>
                    {% endfor %}
                </select>
            </div>
            <div style="margin-bottom: 10px;">
                <label for="amount">Number of Contracts:</label>
                <input type="number" name="amount" id="amount" min="1" required>
            </div>
            <div style="margin-bottom: 10px;">
                <label for="position_type">Position Type:</label>
                <select name="position_type" id="position_type" required>
                    <option value="long">Long</option>
                    <option value="short">Short</option>
                </select>
            </div>
            <button type="submit">Open Position</button>
        </form>
    </div>
    
    <!-- Close Position Form -->
    <div style="margin: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px;">
        <h2>Close Futures Position</h2>
        {% if current_positions %}
        <form method="POST">
            <input type="hidden" name="action" value="close">
            <div style="margin-bottom: 10px;">
                <label for="position_id">Select Position to Close:</label>
                <select name="position_id" id="position_id" required>
                    <option value="">-- Select a position --</option>
                    {% for position in current_positions %}
                    <option value="{{ position[0] }}">{{ position[1] }} - {{ position[2] }} contracts ({{ position[3] }})</option>
                    {% endfor %}
                </select>
            </div>
            <button type="submit">Close Position</button>
        </form>
        {% else %}
        <p>You don't have any open positions to close.</p>
        {% endif %}
    </div>
    
    <!-- Available Futures Contracts Table -->
    <div style="margin: 20px;">
        <h2>Available Futures Contracts</h2>
        <table style="width: 100%; border-collapse: collapse;">
            <tr style="background-color: #f2f2f2;">
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Symbol</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Name</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Price</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Margin Requirement</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Expiry</th>
            </tr>
            {% for future in available_futures %}
            <tr>
                <td style="border: 1px solid #ddd; padding: 8px;">{{ future[0] }}</td>
                <td style="border: 1px solid #ddd; padding: 8px;">{{ future[1] }}</td>
                <td style="border: 1px solid #ddd; padding: 8px;">${{ future[2] }}</td>
                <td style="border: 1px solid #ddd; padding: 8px;">{{ future[3]*100 }}%</td>
                <td style="border: 1px solid #ddd; padding: 8px;">{{ future[4] }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    
    <!-- Current Positions Table -->
    {% if current_positions %}
    <div style="margin: 20px;">
        <h2>Your Current Positions</h2>
        <table style="width: 100%; border-collapse: collapse;">
            <tr style="background-color: #f2f2f2;">
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Position ID</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Symbol</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Contracts</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Position Type</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Margin</th>
            </tr>
            {% for position in current_positions %}
            <tr>
                <td style="border: 1px solid #ddd; padding: 8px;">{{ position[0] }}</td>
                <td style="border: 1px solid #ddd; padding: 8px;">{{ position[1] }}</td>
                <td style="border: 1px solid #ddd; padding: 8px;">{{ position[2] }}</td>
                <td style="border: 1px solid #ddd; padding: 8px;">{{ position[3] }}</td>
                <td style="border: 1px solid #ddd; padding: 8px;">${{ position[4] }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    {% endif %}
    
    <script type="text/javascript" src="{{url_for('static', filename='index.js')}}"></script>
</body>
</html> 